COMPILER = g++
CFLAGS = -O3 -static
PRE_CFLAGS = ${CFLAGS} -c
TARGET = PbO-CCSAT

SRC_DIR = src

MERSENNE = mersenne
MERSENNE_TARGET = ${SRC_DIR}/${MERSENNE}.o
MERSENNE_CC_FILE = ${SRC_DIR}/${MERSENNE}.cc
MERSENNE_H_FILE = ${SRC_DIR}/${MERSENNE}.h
MERSENNE_SOURCE_FILES = ${MERSENNE_H_FILE} ${MERSENNE_CC_FILE}

SOLVER = solver
SOLVER_TARGET = ${SRC_DIR}/${SOLVER}.o
SOLVER_CPP_FILE = ${SRC_DIR}/${SOLVER}.cpp
SOLVER_H_FILE = ${SRC_DIR}/${SOLVER}.h
SOLVER_SOURCE_FILES = ${SOLVER_H_FILE} ${SOLVER_CPP_FILE}

TARGET_FILES =  ${MERSENNE_TARGET} \
				${SOLVER_TARGET} \
				

MAIN_SOURCE_FILE = ${SRC_DIR}/main.cpp


CLEAN = clean
CLEANUP = cleanup


all: ${TARGET_FILES} ${TARGET} ${CLEAN}


${MERSENNE_TARGET}: ${MERSENNE_SOURCE_FILES}
	${COMPILER} ${PRE_CFLAGS} ${MERSENNE_CC_FILE} -o ${MERSENNE_TARGET}

${SOLVER_TARGET}: ${SOLVER_SOURCE_FILES}
	${COMPILER} ${PRE_CFLAGS} ${SOLVER_CPP_FILE} -o ${SOLVER_TARGET}

${TARGET}: ${MAIN_SOURCE_FILE} ${TARGET_FILES}
	${COMPILER} ${CFLAGS} ${MAIN_SOURCE_FILE} ${TARGET_FILES} -o ${TARGET}

${CLEAN}:
	rm -f *~
	rm -f ${SRC_DIR}/*.o
	rm -f ${SRC_DIR}/*~

${CLEANUP}: ${CLEAN}
	rm -f ${TARGET}